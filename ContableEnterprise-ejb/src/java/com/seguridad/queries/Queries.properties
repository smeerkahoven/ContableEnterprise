# To change this license header, choose License Headers in Project Properties.
# To change this template file, choose Tools | Templates
# and open the template in the editor.

#GET_MENU=select m.nombre as modulo, m.status as modulo_status,f.nombre as formulario, f.url_acceso,f.restful_url, f.status as formulario_acceso, rf.acceder,rf.actualizar,rf.buscar, rf.crear, rf.eliminar from tb_rol_formulario rf inner join tb_formularios f on f.id_formulario = rf.id_formularios inner join tb_modulos m on m.id_modulo = f.id_modulo
GET_MENU=SELECT m.nombre , m.status, f.nombre , f.url_acceso, f.restful_url, f.status , rf.acceder,rf.actualizar,rf.buscar, rf.crear, rf.eliminar,m.class_menu, m.url_acceso, f.id_formulario, rf.ver, rf.editar, rf.anular,rf.ejecutar, f.full_path FROM tb_rol_formulario rf INNER JOIN tb_formularios f on f.id_formulario = rf.id_formularios INNER JOIN tb_modulos m on m.id_modulo = f.id_modulo WHERE rf.id_rol = ?1 ORDER BY m.nombre, f.nombre
GET_EMPRESA_CENTRAL=select * from tb_empresa where tipo='CENTRAL'
GET_SUCURSALES=select * from tb_empresa where tipo='SUCURSAL'
GET_EMPLEADOS=SELECT emp.id_empleado ,emp.nombre,emp.apellido, emp.email, emp.telefono, emp.fecha_alta , emp.fecha_baja , emp.status, emp.id_empresa , razon_social as razonSocial, cargo, sexo FROM db_travel.tb_empleado emp INNER JOIN db_travel.tb_empresa pr  ON pr.id_empresa =emp.id_empresa
GET_EMPLEADOS_COMBO_USUARIO=SELECT * FROM tb_empleado WHERE id_empleado NOT IN ( SELECT e.id_empleado FROM tb_empleado e INNER JOIN tb_user u ON u.id_empleado = e.id_empleado)
GET_MODULO_EDIT=select m.id_modulo, m.nombre, m.status, m.class_menu, f.id_formulario, f.nombre, f.status,  r.crear, r.actualizar, r.eliminar, r.acceder, r.buscar,  r.ver, r.editar, r.anular, r.ejecutar,r.id_rol_formulario, r.id_rol from tb_modulos m inner join tb_formularios f on f.id_modulo = m.id_modulo inner join tb_rol_formulario r on r.id_formularios = f.id_formulario where r.id_rol =?1 order by m.id_modulo, m.nombre, f.id_formulario, f.nombre
GET_MODULO_NUEVO=select m.id_modulo, m.nombre, m.status, m.class_menu,f.id_formulario, f.nombre, f.status,0 as crear, 0 as actualizar, 0 as eliminar, 0 as acceder, 0 as buscar, 0 as ver, 0 as editar, 0 as anular, 0 as ejecutar from tb_modulos m inner join tb_formularios f on f.id_modulo = m.id_modulo order by m.id_modulo, m.nombre, f.id_formulario, f.nombre
GET_BANCO_CUENTA_LINK=select b.id_cuenta_banco,b.id_plan_cuentas,pc.nro_plan_cuenta, pc.cuenta, b.id_banco,  b.descripcion FROM cnt_cuenta_banco b INNER JOIN cnt_plan_cuentas pc ON pc.id_plan_cuentas = b.id_plan_cuentas WHERE id_banco= ?1
GET_PLAN_CUENTA_PADRE=select * from cnt_plan_cuentas where nro_plan_cuenta=?1 and id_empresa = ?2
GET_AEROLINA_CUENTA=select ac.id_aerolinea,ac.id_aerolinea_cuenta,ac.id_plan_cuentas,ac.tipo,ac.moneda,pc.nro_plan_cuenta, concat(pc.cuenta,' - ', e.tipo, (case e.tipo when 'SUCURSAL' THEN  concat('-',e.direccion) ELSE ''  end ))as nombreCuenta from cnt_aerolinea_cuenta ac inner join cnt_plan_cuentas pc on pc.id_plan_cuentas = ac.id_plan_cuentas inner join tb_empresa e on e.id_empresa=pc.id_empresa where ac.id_aerolinea=?1 and ac.tipo =?2 and ac.moneda=?3
GET_PLAN_CUENTAS_NRO_PLANCUENTA=SELECT p.id_plan_cuentas,p.nro_plan_cuenta, concat(cuenta,' - ', e.tipo, (case e.tipo when 'SUCURSAL' THEN  concat('-',e.direccion) ELSE ''  end ))as cuenta FROM cnt_plan_cuentas p inner join tb_empresa e on e.id_empresa=p.id_empresa WHERE p.nro_plan_cuenta_padre=?1 ORDER BY p.nro_plan_cuenta, p.cuenta, p.nivel asc;
GET_BANCOS_CUENTAS_EMPRESA=SELECT c.id_plan_cuentas as id, concat(b.nombre , ' - ', c.descripcion )as name FROM cnt_bancos b inner join cnt_cuenta_banco c on c.id_banco= b.id_banco inner join cnt_plan_cuentas p on c.id_plan_cuentas = p.id_plan_cuentas where p.id_empresa = ?1
GET_NOTA_DEBITO_BOLETOS=select distinct nd.id_nota_debito, nd.id_empresa, nd.id_cliente, nd.id_counter,nd.fecha_emision, nd.fecha_insert, nd.monto_total_bs, nd.monto_total_usd, nd.monto_adeudado_bs,nd.monto_adeudado_usd,nd.factor_cambiario,nd.forma_pago, nd.tipo_contado, nd.id_banco, nd.nro_cheque, nd.id_tarjeta_credito, nd.nro_tarjeta, nd.nro_deposito, nd.id_cuenta_deposito, nd.id_usuario_creador, nd.credito_dias, nd.credito_vencimiento, nd.credito_vencimiento, nd.combinado_contado, nd.combinado_tarjeta,nd.combinado_contado_tipo, nd.estado from cnt_nota_debito nd left join cnt_nota_debito_transaccion dt on dt.id_nota_debito = nd.id_nota_debito left join cnt_boleto bo on bo.id_boleto = dt.id_boleto WHERE nd.id_empresa=?1 
GET_INGRESO_CAJA=select c.id_ingreso_caja, c.id_usuario, c.id_empresa,c.id_cliente, c.fecha_emision, c.fecha_insert, c.monto_abonado_bs, c.monto_abonado_usd, c.factor_cambiario, c.forma_pago, c.id_banco, c.nro_cheque, c.id_tarjeta_credito, c.nro_tarjeta, c.nro_deposito, c.id_cuenta_deposito, c.estado from cnt_ingreso_caja c WHERE c.id_empresa=?1 
GET_NOTA_CREDITO=select nc.id_nota_credito, nc.id_usuario, nc.id_empresa, nc.id_cliente, nc.fecha_emision, nc.fecha_insert, nc.monto_abonado_bs, nc.monto_abonado_usd, nc.factor_cambiario, nc.concepto, nc.estado from cnt_nota_credito nc where nc.id_empresa =?1
GET_NOTA_CREDITO_TRX_BY_ID_NOTA_DEBITO=select nctr.id_nota_credito_transaccion, nctr.id_nota_credito, nctr.id_plan_cuenta, nctr.descripcion, nctr.monto_bs, nctr.monto_usd, nctr.moneda, nctr.fecha_insert, nctr.id_nota_transaccion, nctr.estado, nctr.id_usuario_creador from cnt_nota_credito_transaccion nctr  inner join cnt_nota_debito_transaccion ndtr on ndtr.id_nota_debito_transaccion=nctr.id_nota_transaccion where ndtr.id_nota_debito = ?1
GET_PAGO_ANTICIPADO_TRX_BY_ID_NOTA_DEBITO=select patr.id_pago_anticipado_transaccion, patr.id_pago_anticipado, patr.id_nota_debito_transaccion, patr.descripcion, patr.monto, patr.fecha_insert, patr.id_usuario_creador, patr.estado, patr.moneda from cnt_pago_anticipado_transaccion patr inner join cnt_nota_debito_transaccion ndtr on ndtr.id_nota_debito_transaccion=ndtr.id_nota_debito_transaccion where ndtr.id_nota_debito=?1
GET_INGRESO_TRX_BY_ID_NOTA_DEBITO=SELECT ictr.id_transaccion, ictr.id_ingreso_caja,  ictr.descripcion, ictr.moneda, ictr.monto_bs, ictr.monto_usd, ictr.fecha_insert,  ictr.id_nota_transaccion, ictr.estado FROM db_travel.cnt_ingreso_transaccion ictr inner join cnt_nota_debito_transaccion ndtr on ndtr.id_nota_debito_transaccion = ictr.id_nota_transaccion where ndtr.id_nota_debito = ?1 

GET_NEXT_ID_LIBRO=SELECT CAST(count(id_libro) + 1 as unsigned int) as id_next from cnt_comprobante_contable where tipo=?1 and gestion=?2

DELETE_AEROLINEA=DELETE FROM cnt_aerolinea WHERE id_aerolinea = ?1
DELETE_AEROLINEA_CUENTA=DELETE FROM cnt_aerolinea_cuenta WHERE id_aerolinea_cuenta=?1
DELETE_PLAN_CUENTAS=DELETE FROM cnt_plan_cuentas WHERE id_plan_cuentas= ?1 and id_empresa= ?2
DELETE_IMPUESTO_AEROLINEA=delete  from cnt_aerolinea_impuesto WHERE id_aerolinea_impuesto=?1
DELETE_COMISION_PROMOTOR_AEROLINEA=delete from cnt_com_promotor_aerolinea WHERE id_comision_promotor=?1
DELETE_CUENTA_BANCO=DELETE FROM cnt_cuenta_banco WHERE id_cuenta_banco=?1
DELETE_CLIENTE=DELETE FROM cnt_cliente WHERE id_cliente=?1
DELETE_CLIENTE_SOLICITADO=DELETE FROM cnt_cliente_solicitado WHERE id_cliente_solicitado=?1

UPDATE_COMPROBANTE_CONTABLE_ESTADO=UPDATE cnt_comprobante_contable SET estado=?1, id_usuario_anulado=?2 WHERE id_libro=?3
UPDATE_COMPROBANTE_CONTABLE_TOTALES=UPDATE cnt_comprobante_contable SET totalDebeNac=?1, totalHaberNac=?2, totalDebeExt=?3, totalHaberExt=?4 WHERE id_libro=?5
DELETE_COMPROBANTE_TRANSACTION=DELETE from cnt_asiento_contable WHERE id_asiento=?1

UPDATE_NOTA_DEBITO_ESTADO=UPDATE cnt_nota_debito SET id_cliente=?2, id_counter=?3, fecha_emision=?4, factor_cambiario=?5,estado=?6,forma_pago = ?7, id_banco=?8, nro_cheque=?9, id_tarjeta_credito=?10,nro_tarjeta=?11, nro_deposito=?12, id_cuenta_deposito =?13, credito_dias=?14, credito_vencimiento=?15, gestion=?16 WHERE id_nota_debito=?1

GET_NOTA_DEBITO_TRANSACCIONES_CREDITO_DEBE=select ndt.id_nota_debito_transaccion,ndt.id_nota_debito, ndt.descripcion, ndt.monto_bs, ndt.monto_usd, ndt.monto_adeudado_bs, ndt.monto_adeudado_usd, ndt.fecha_insert,ndt.id_boleto, ndt.id_cargo, ndt.estado, ndt.tipo,ndt.moneda, ndt.id_usuario from cnt_nota_debito_transaccion ndt inner join cnt_nota_debito nd ON nd.id_nota_debito = ndt.id_nota_debito where nd.forma_pago = 'C' and nd.estado in ('E','M') and ndt.estado in ('E','M') and nd.id_cliente=?1 and nd.id_empresa =?2 ORDER BY nd.id_nota_debito
GET_PAGO_ANTICIPADO=select p.id_pago_anticipado, p.id_cliente, p.factor_cambiario, p.moneda, p.monto_anticipado, p.monto_total_acreditado, p.concepto, p.forma_pago, p.nro_cheque, p.id_banco, p.id_cuenta_deposito, p.nro_deposito, p.id_tarjeta_credito, p.nro_tarjeta, p.id_usuario_creador, p.fecha_insert, p.estado, p.id_empresa, p.fecha_emision from cnt_pago_anticipado p left join cnt_pago_anticipado_transaccion pat on pat.id_pago_anticipado = p.id_pago_anticipado  where p.id_empresa = ?1 

GET_MAYORES_NAC=select ac.id_asiento, ac.id_libro,cc.fecha, ac.gestion, ac.fecha_movimiento,ac. id_plan_cuenta, ac.monto_debe_nac monto_debe, ac.monto_haber_nac monto_haber, ac.id_boleto, ac.id_cargo, ac.id_nota_transaccion, ac.id_ingreso_caja_transaccion, ac.id_nota_credito_transaccion, ac.id_pago_anticipado, ac.id_pago_anticipado_transaccion, cc.id_cliente, cc.id_numero_gestion, cc.gestion, cc.concepto, cc.factor_cambiario, cc.tipo from cnt_asiento_contable ac inner join cnt_comprobante_contable cc on cc.id_libro = ac.id_libro where cc.id_empresa=?1
GET_MAYORES_EXT=select ac.id_asiento, ac.id_libro,cc.fecha, ac.gestion, ac.fecha_movimiento,ac. id_plan_cuenta, ac.monto_debe_ext monto_debe, ac.monto_haber_ext monto_haber, ac.id_boleto, ac.id_cargo, ac.id_nota_transaccion, ac.id_ingreso_caja_transaccion, ac.id_nota_credito_transaccion, ac.id_pago_anticipado, ac.id_pago_anticipado_transaccion, cc.id_cliente, cc.id_numero_gestion, cc.gestion, cc.concepto, cc.factor_cambiario, cc.tipo from cnt_asiento_contable ac inner join cnt_comprobante_contable cc on cc.id_libro = ac.id_libro where cc.id_empresa=?1

GET_MAYORES_ACUMULADOS_NAC=select sum(ac.monto_debe_nac)monto_acumulado_debe, sum(ac.monto_haber_nac)monto_acumulado_haber from cnt_asiento_contable ac inner join cnt_comprobante_contable cc on cc.id_libro = ac.id_libro where cc.id_empresa=?1
GET_MAYORES_ACUMULADOS_EXT=select sum(ac.monto_debe_ext)monto_acumulado_debe, sum(ac.monto_haber_ext)monto_acumulado_haber from cnt_asiento_contable ac inner join cnt_comprobante_contable cc on cc.id_libro = ac.id_libro where cc.id_empresa=?1